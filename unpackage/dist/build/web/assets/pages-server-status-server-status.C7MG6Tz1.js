import{r as a,A as e,a as s,c as l,w as t,y as u,i as r,o as n,b as v,f as c,g as o,F as d,e as i,d as f,t as _,n as m,l as y,S as p,k,m as x}from"./index-BYM3QoI5.js";import{_ as g,o as h,r as T,a as b}from"./my-nav.DzxSQuJa.js";import{a as S}from"./system.CW8TmTMb.js";const w=g({__name:"server-status",setup(g){const w=a(S()+66),C=a([{name:"SRV主入口",addr:"bc.vincentzyu233.cn"},{name:"IP+PORT直连",addr:"sh-aliyun2.vincentzyu233.cn:53332"}]),I=a(0),P=a(!1),j=a(""),R=a({}),z=e((()=>{var a;return(null==(a=R.value)?void 0:a.online)?"online":"offline"})),N=e((()=>{var a;return(null==(a=R.value)?void 0:a.online)?"在线":"离线"}));async function E(){j.value="",P.value=!0,R.value={};try{const a=C.value[I.value].addr,e=`https://us-cc.vincentzyu233.cn/fastapi_wrap/mcjava/server_status/${encodeURIComponent(a)}`,s=await u({url:e,method:"GET",timeout:15e3});if(!(s.statusCode>=200&&s.statusCode<300))throw new Error(`HTTP ${s.statusCode}`);R.value=s.data||{}}catch(a){console.error("[server-status] fetch error",a),j.value=String((null==a?void 0:a.message)||a)}finally{P.value=!1}}const F=a(Number(4));return h((a=>{F.value=(null==a?void 0:a.LastIdx)?Number(a.LastIdx):4,E()})),(a,e)=>{const u=r,g=p,h=k,S=x,L=T(s("my-nav"),b);return n(),l(u,{class:"server-status-page"},{default:t((()=>[v(u,{class:"WorksPage pageBg"}),v(g,{class:"serverTabsScroll","scroll-x":"",style:i({height:w.value+"px"})},{default:t((()=>[(n(!0),c(d,null,o(C.value,((a,e)=>(n(),l(u,{key:a.addr,class:m(["ServerTab",I.value===e?"active":""]),onClick:a=>{return s=e,void(I.value!==s&&(I.value=s,E()));var s}},{default:t((()=>[v(u,{class:"ServerTabText"},{default:t((()=>[f(_(a.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1},8,["style"]),v(g,{class:"content-scroll","scroll-y":""},{default:t((()=>[v(u,{class:"content",style:i({paddingTop:w.value+"px"})},{default:t((()=>[P.value?(n(),l(u,{key:0,class:"loading"},{default:t((()=>[v(u,{class:"spinner"}),v(h,null,{default:t((()=>[f("正在加载服务器信息...")])),_:1})])),_:1})):j.value?(n(),l(u,{key:1,class:"error"},{default:t((()=>[v(h,null,{default:t((()=>[f("加载失败："+_(j.value),1)])),_:1})])),_:1})):(n(),l(u,{key:2,class:"details"},{default:t((()=>[v(u,{class:"summary"},{default:t((()=>[v(u,{class:m(["status",z.value])},{default:t((()=>[f(_(N.value),1)])),_:1},8,["class"]),v(u,{class:"title"},{default:t((()=>[f(_(R.value.host)+":"+_(R.value.port),1)])),_:1}),v(u,{class:"ip"},{default:t((()=>[f("IP: "+_(R.value.ip_address||"-"),1)])),_:1})])),_:1}),v(u,{class:"kv"},{default:t((()=>[v(h,{class:"k"},{default:t((()=>[f("版本")])),_:1}),v(h,{class:"v"},{default:t((()=>{var a;return[f(_((null==(a=R.value.version)?void 0:a.name_clean)||"-"),1)]})),_:1})])),_:1}),v(u,{class:"kv"},{default:t((()=>[v(h,{class:"k"},{default:t((()=>[f("在线玩家")])),_:1}),v(h,{class:"v"},{default:t((()=>{var a,e;return[f(_((null==(a=R.value.players)?void 0:a.online)??"-")+" / "+_((null==(e=R.value.players)?void 0:e.max)??"-"),1)]})),_:1})])),_:1}),v(u,{class:"kv"},{default:t((()=>[v(h,{class:"k"},{default:t((()=>[f("MOTD")])),_:1}),v(h,{class:"v"},{default:t((()=>{var a;return[f(_((null==(a=R.value.motd)?void 0:a.clean)||"-"),1)]})),_:1})])),_:1}),R.value.srv_record?(n(),l(u,{key:0,class:"kv"},{default:t((()=>[v(h,{class:"k"},{default:t((()=>[f("SRV")])),_:1}),v(h,{class:"v"},{default:t((()=>[f(_(R.value.srv_record.host)+":"+_(R.value.srv_record.port),1)])),_:1})])),_:1})):y("",!0),R.value.icon?(n(),l(S,{key:1,src:R.value.icon,mode:"aspectFit",class:"server-icon"},null,8,["src"])):y("",!0)])),_:1}))])),_:1},8,["style"])])),_:1}),v(L,{class:"down-nav",y:Number(4),x:F.value},null,8,["y","x"])])),_:1})}}},[["__scopeId","data-v-1cec0937"]]);export{w as default};
