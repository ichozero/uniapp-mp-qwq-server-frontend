import{r as a,p as e,a as s,c as n,w as r,s as l,i as t,o as u,b as o,f as c,g as d,F as v,d as i,l as f,q as m,k as p,n as y,m as b,v as _}from"./index-D79phuLK.js";import{_ as g,o as x,r as L,a as h}from"./my-nav.CW2L8Bme.js";import{q as k,B as w}from"./request.IyGYDfKt.js";import{S as B}from"./system.VgJ8Gk4z.js";const q=g({__name:"banner",setup(g){const q=a(0),S=a(!0),j=a({}),E=a=>{q.value=a.detail.current};const I=a([]),C=a([]);async function F(){try{await async function(){var a;try{S.value=!0;const e=await k({url:"mpbackend/api/banner/list"});I.value=null==(a=null==e?void 0:e.data)?void 0:a.data,C.value=[],j.value={},I.value.forEach(((a,e)=>{const s=B.safeArea.height>B.safeArea.width?w+`mpbackend/api/banner/file_rotate/${a}`:w+`mpbackend/api/banner/file/${a}`;C.value.push(s),j.value[e]=!1})),S.value=!1}catch(e){console.error("加载banner内容失败",e),S.value=!0}}()}catch(a){l({title:"[qwq]获取markdown的时候网络请求发生错误,请将此页面截图,并联系开发人员VincentZyu",content:`onLoad()回调函数里面发生了未知错误, err = ${a}`,showCancel:!1})}}x((()=>{F()}));const N=a(Number(0));return x((a=>{N.value=a.LastIdx?Number(a.LastIdx):0})),(a,l)=>{const g=e("my-nav-bar"),x=b,k=t,w=_,B=m,I=p,F=L(s("my-nav"),h);return u(),n(k,{class:"indexLayoutRoot"},{default:r((()=>[o(k,{class:"indexLayout pageBg"},{default:r((()=>[o(g,{bgType:"OrangeFrostedGlass"}),o(k,{class:"banner"},{default:r((()=>[o(B,{autoplay:"",circular:"",vertical:"","easing-function":"easeOutCubic",onChange:E},{default:r((()=>[(u(!0),c(v,null,d(C.value,((a,e)=>(u(),n(w,{key:e},{default:r((()=>[o(k,{class:"BannerImageWrapper"},{default:r((()=>[o(x,{class:y([q.value==e?"selected":""]),src:a,mode:"aspectFill",onLoad:()=>{return a=e,j.value||(j.value={}),void(j.value[a]=!0);var a},onError:()=>{return a=e,j.value||(j.value={}),void(j.value[a]="error");var a}},null,8,["class","src","onLoad","onError"]),j.value&&!1===j.value[e]?(u(),n(k,{key:0,class:"BannerSpinner"},{default:r((()=>[o(k,{class:"SpinnerSmall"})])),_:1})):f("",!0),j.value&&"error"===j.value[e]?(u(),n(k,{key:1,class:"BannerErrorText"},{default:r((()=>[i("图片加载失败")])),_:1})):f("",!0)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),S.value?(u(),n(k,{key:0,class:"BannerLoadingOverlay"},{default:r((()=>[o(k,{class:"SpinnerLarge"}),o(I,{class:"BannerLoadingText"},{default:r((()=>[i("正在获取banner图片，请稍等....")])),_:1})])),_:1})):f("",!0)])),_:1})])),_:1}),o(F,{class:"down-nav",y:Number(0),x:N.value},null,8,["y","x"])])),_:1})}}},[["__scopeId","data-v-7cf2c338"]]);export{q as default};
